(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/active/active_Order"],{"0614":function(e,t,n){"use strict";(function(e,t){var o=n("47a9");n("d090");o(n("3240"));var r=o(n("e1eb"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(r.default)}).call(this,n("3223")["default"],n("df3c")["createPage"])},"17fc":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n("b816"),r={data:function(){return{coverImage:"",activeId:"",productInfo:{},dataProductInfo:{},number:1,sumPrice:0,dateFlag:!1,contacts:"",phone:"",address:"",wechat:"",remark:"",subFlag:!1,formData:{contacts:"",phone:"",address:"",wechat:""},rules:{contacts:{rules:[{required:!0,errorMessage:"联系人不能为空"}]},phone:{rules:[{required:!0,errorMessage:"手机号不能为空"},{pattern:"^1[3-9]\\d{9}$",errorMessage:"手机号格式不正确"}]}}}},onLoad:function(t){var n=this;if(this.coverImage=t.coverImage,this.activeId=t.activeId,0==t.stockType){var o={};o.id=t.id,this.request("/app_api/activity/getProductInfo",o,"GET").then((function(e){e&&200==e.code&&(n.productInfo=e.data,n.sumPrice=n.productInfo.price*n.number,n.subFlag=!0)}))}if(1==t.stockType){var r={};r.id=t.id,this.request("/app_api/activity/getProductInfo",r,"GET").then((function(o){if(console.log("getProductInfo",o),o&&200==o.code){n.productInfo=o.data;var r={};r.stockDate=t.currDate,r.skiActivityProductId=t.id,n.request("/app_api/activity/getDataProductInfo",r,"GET").then((function(t){if(t&&200==t.code){if(0==t.data.length)return console.log("未查到数据"),void e.showToast({title:"当前没有库存",icon:"none",duration:3e3});if(0==t.data[0].stockNumber)return console.log("库存为0"),void e.showToast({title:"当前没有库存",icon:"none",duration:3e3});n.dataProductInfo=t.data[0],n.sumPrice=n.productInfo.price*n.number,n.dateFlag=!0,n.subFlag=!0}}))}}))}},methods:{numberChange:function(e){this.number=e,this.sumPrice=this.productInfo.price*this.number},submit:function(t){var n=this;this.$refs[t].validate().then((function(t){var r={};r.appToken=(0,o.getToken)(),r.skiActivityInfoId=n.activeId,r.skiActivityProductId=n.productInfo.id,r.dataProductId=n.dataProductInfo.id,r.useDate=n.dataProductInfo.stockDate,r.saleNumber=n.number,r.contacts=n.formData.contacts,r.phone=n.formData.phone,r.address=n.formData.address,r.wechat=n.formData.wechat,r.remark=n.remark,r.coverImage=n.coverImage,n.number<=0&&e.showToast({title:"购买数量不能为0",icon:"none",duration:3e3}),n.request("/app_api/activity/addActiveOrder",r,"POST").then((function(t){console.log("addActiveOrder:",t),t&&(200==t.code&&e.reLaunch({url:"/pages/active/pay?orderId="+t.data.id+"&type=0"}),500==t.code&&e.showToast({title:t.msg,icon:"none",duration:3e3}))}))})).catch((function(e){console.log("err",e)}))}}};t.default=r}).call(this,n("df3c")["default"])},"29a6":function(e,t,n){"use strict";var o=n("b4b0"),r=n.n(o);r.a},b4b0:function(e,t,n){},d4e8:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return o}));var o={uniNumberBox:function(){return n.e("uni_modules/uni-number-box/components/uni-number-box/uni-number-box").then(n.bind(null,"9503"))},uniForms:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uni-forms/components/uni-forms/uni-forms")]).then(n.bind(null,"8d8a"))},uniFormsItem:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uni-forms/components/uni-forms-item/uni-forms-item")]).then(n.bind(null,"34a0"))}},r=function(){var e=this.$createElement;this._self._c},a=[]},dd59:function(e,t,n){"use strict";n.r(t);var o=n("17fc"),r=n.n(o);for(var a in o)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(a);t["default"]=r.a},e1eb:function(e,t,n){"use strict";n.r(t);var o=n("d4e8"),r=n("dd59");for(var a in r)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(a);n("29a6");var i=n("828b"),u=Object(i["a"])(r["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],void 0);t["default"]=u.exports}},[["0614","common/runtime","common/vendor"]]]);