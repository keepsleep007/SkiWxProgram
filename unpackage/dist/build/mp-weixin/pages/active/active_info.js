(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/active/active_info"],{"0891":function(t,e,a){"use strict";(function(t){var i=a("47a9");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var c=i(a("7eb4")),n=i(a("ee10")),r=a("b816"),o={components:{},data:function(){return{activeId:"",imgList:[],data:{},activityTagList:[],infoRichTextFlag:!1,priceRichTextFlag:!1,shortRichTextFlag:!1,disclaimerRichTextFlag:!1,productList:[],dateClass:"none",dateSelected:[],dateSelectedId:"",currDate:this.getDate().fullDate}},onLoad:function(t){var e=this;return(0,n.default)(c.default.mark((function a(){var i;return c.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:i=t.id,i&&(e.getDataInfo(i),e.getActivityTag(),e.activeId=i);case 2:case"end":return a.stop()}}),a)})))()},onShareAppMessage:function(t){return"button"===t.from&&console.log(t.target),{title:"分享了活动信息，一起看看吧~",path:"/pages/active/active_info?id="+this.activeId}},methods:{getDataInfo:function(t){var e=this,a={};a.id=t,this.request("/app_api/activity/getActivityInfo",a,"GET").then((function(t){if(console.log("getActivityInfo",t),t&&200==t.code){for(var a=t.data.bannerImage.split(","),i=[],c=0;c<a.length;c++)i[c]={},i[c]["src"]=a[c];e.imgList=i,t.data.shortRichText&&(t.data.shortRichText=e.fixImageSrcInHtml(t.data.shortRichText,e.getBaseUrl()),"<p><br></p>"===t.data.shortRichText?e.shortRichTextFlag=!1:e.shortRichTextFlag=!0),t.data.infoRichText&&(t.data.infoRichText=e.fixImageSrcInHtml(t.data.infoRichText,e.getBaseUrl()),"<p><br></p>"===t.data.infoRichText?e.infoRichTextFlag=!1:e.infoRichTextFlag=!0),t.data.priceRichText&&(t.data.priceRichText=e.fixImageSrcInHtml(t.data.priceRichText,e.getBaseUrl()),"<p><br></p>"===t.data.priceRichText?e.priceRichTextFlag=!1:e.priceRichTextFlag=!0),e.data=t.data,e.getDisclaimerRichText(t.data.skiDisclaimerId),e.getActiveProduct(t.data.id)}}))},getActivityTag:function(){var t=this;this.request("/app_api/activity/loadActivityTag","GET").then((function(e){e&&(t.activityTagList=e.data)}))},getActiveProduct:function(t){var e=this,a={};a.id=t,this.request("/app_api/activity/getActiveProduct",a,"GET").then((function(t){if(console.log("getActiveProduct",t),t&&200==t.code){for(var a=0;a<t.data.length;a++)0==t.data[a].stockType&&0==t.data[a].stockNumber&&(t.data[a].s_btn_color=!0);e.productList=t.data}}))},getDisclaimerRichText:function(t){var e=this,a={};a.skiDisclaimerId=t,this.request("/app_api/activity/getDisclaimer",a,"GET").then((function(t){console.log("getDisclaimer",t),t&&200==t.code&&t.data&&(t.data.disclaimerRichText&&(t.data.disclaimerRichText=e.fixImageSrcInHtml(t.data.disclaimerRichText,e.getBaseUrl()),e.disclaimerRichTextFlag=!0),e.data.disclaimerRichText=t.data.disclaimerRichText)}))},productBtn:function(e){var a=this;if((0,r.needLogin)()&&void 0==(0,r.getUserInfo)())t.navigateTo({url:"/pages/me/login-page"});else{var i={};i.id=e,this.request("/app_api/activity/getProductInfo",i,"GET").then((function(t){if(t&&200==t.code)if(0==t.data.stockType)a.subProduct(e,0);else if(1==t.data.stockType){var i={};i.skiActivityProductId=t.data.id,a.request("/app_api/activity/getDataProductInfo",i,"GET").then((function(t){if(t&&200==t.code){for(var i=[],c=0;c<t.data.length;c++)i[c]={},i[c]["date"]=t.data[c].stockDate,i[c]["info"]="库存："+t.data[c].stockNumber;a.dateSelected=i,a.dateSelectedId=e,a.toggleSpecDateProduct()}}))}}))}},subProduct:function(e,a){0==a?t.navigateTo({url:"/pages/active/active_Order?id="+e+"&activeId="+this.activeId+"&stockType="+a+"&coverImage="+this.data.coverImage}):1==a&&t.navigateTo({url:"/pages/active/active_Order?id="+e+"&activeId="+this.activeId+"&stockType="+a+"&currDate="+this.currDate+"&coverImage="+this.data.coverImage})},toggleSpecDateProduct:function(){var t=this;"show"===this.dateClass?(this.dateClass="hide",setTimeout((function(){t.dateClass="none"}),250)):"none"===this.dateClass&&(this.dateClass="show")},dateChange:function(t){console.log("change 返回:",t),this.currDate=t.fulldate},monthSwitch:function(t){console.log("monthSwitchs 返回:",t)},selectSpec:function(t,e){var a=this,i=this.specChildList;i.forEach((function(t){t.pid===e&&a.$set(t,"selected",!1)})),this.$set(i[t],"selected",!0),this.specSelected=[],i.forEach((function(t){!0===t.selected&&a.specSelected.push(t)}))},shareFunc:function(){this.$refs.share.toggleMask()},toFavorite:function(){this.favorite=!this.favorite},buy:function(){t.navigateTo({url:"/pages/order/createOrder"})},stopPrevent:function(){},fixImageSrcInHtml:function(t,e){if(t){var a,i=/src="([^"]+)"/g,c=[];while(null!==(a=i.exec(t))){var n=a[1];n.startsWith("/profile")?c.push(e+n):c.push(n)}var r=t;return c.forEach((function(e,a){var c=i.exec(t)[1];r=r.replace(c,e)})),console.log("fixImageSrcRestoreUrls处理后的HTML：",r),r}console.error("HTML文本不能为空")},getDate:function(){var t=new Date,e=t.getFullYear(),a=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,i=t.getDate()<10?"0"+t.getDate():t.getDate();return{fullDate:e+"-"+a+"-"+i,year:e,month:a,date:i,day:t.getDay()}}}};e.default=o}).call(this,a("df3c")["default"])},"18df":function(t,e,a){"use strict";a.r(e);var i=a("0891"),c=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(n);e["default"]=c.a},1933:function(t,e,a){"use strict";a.r(e);var i=a("7d58"),c=a("18df");for(var n in c)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return c[t]}))}(n);a("845d");var r=a("828b"),o=Object(r["a"])(c["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],void 0);e["default"]=o.exports},"394c":function(t,e,a){},"7d58":function(t,e,a){"use strict";a.d(e,"b",(function(){return c})),a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){return i}));var i={uniCalendar:function(){return Promise.all([a.e("common/vendor"),a.e("uni_modules/uni-calendar/components/uni-calendar/uni-calendar")]).then(a.bind(null,"9597"))}},c=function(){var t=this,e=t.$createElement,a=(t._self._c,t.getBaseUrl());t._isMounted||(t.e0=function(e,a){var i=arguments[arguments.length-1].currentTarget.dataset,c=i.eventParams||i["event-params"];a=c.item;1!=a.s_btn_color&&t.productBtn(a.id)}),t.$mp.data=Object.assign({},{$root:{m0:a}})},n=[]},"845d":function(t,e,a){"use strict";var i=a("394c"),c=a.n(i);c.a},c01b:function(t,e,a){"use strict";(function(t,e){var i=a("47a9");a("d090");i(a("3240"));var c=i(a("1933"));t.__webpack_require_UNI_MP_PLUGIN__=a,e(c.default)}).call(this,a("3223")["default"],a("df3c")["createPage"])}},[["c01b","common/runtime","common/vendor"]]]);