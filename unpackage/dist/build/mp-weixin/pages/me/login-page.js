(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/me/login-page"],{"3c13":function(t,e,n){"use strict";n.r(e);var i=n("54c1"),o=n("4f6a");for(var a in o)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(a);n("514d");var s=n("828b"),c=Object(s["a"])(o["default"],i["b"],i["c"],!1,null,"4518a90c",null,!1,i["a"],void 0);e["default"]=c.exports},"4f6a":function(t,e,n){"use strict";n.r(e);var i=n("8f7a"),o=n.n(i);for(var a in i)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(a);e["default"]=o.a},"514d":function(t,e,n){"use strict";var i=n("a8ac"),o=n.n(i);o.a},"54c1":function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){}));var i=function(){var t=this.$createElement;this._self._c},o=[]},"8f7a":function(t,e,n){"use strict";(function(t,i){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=n("b91a"),a=n("b816"),s={data:function(){return{isAuth:!1,avatarUrl:"/static/img/login/defaultAvatar.png",nickname:"",isFrist:"",savepth:""}},onLoad:function(){var e=t.getStorageSync("AlertLogin");console.log("AlertLogin",e),e?(console.log("登录过一次"),this.isFrist=2):(console.log("首次登录"),this.isFrist=1)},methods:{authLogin:function(){1==this.isFrist?this.isAuth=!0:(this.isAuth=!1,this.WxgetUserProfile())},closePopup:function(){this.isAuth=!1},onNickname:function(t){this.nickname=t.detail.value},onChooseAvatar:function(t){var e=this;(0,o.pathToBase64)(t.detail.avatarUrl).then((function(t){e.avatarUrl=t})).catch((function(t){console.error(t)})),this.uploadFile(t.detail.avatarUrl)},WxgetUserProfile:function(){var e=this,n={};if(1==this.isFrist){if(console.log("首次登录"),!this.nickname)return void t.showToast({title:"请输入昵称",icon:"",duration:2e3});n.nickName=this.nickname,n.avatarUrl=this.savepth,n.isFrist="1"}else console.log("非首次登录"),n.isFrist="2";t.showLoading({title:"登录中..."}),i.login({success:function(t){console.log(t,"res"),n.code=t.code}}),t.getUserProfile({desc:"用于完善会员资料",success:function(i){e.request("/app_api/wxlogin/login",n,"POST").then((function(e){console.log("wxloginres: ",e),200==e.code?(t.hideLoading(),setTimeout((function(){t.hideLoading()}),2e3),(0,a.setToken)(e.data.id),(0,a.setUserInfo)(e.data),t.setStorageSync("AlertLogin","2"),console.log("登录成功"),t.navigateBack({delta:1})):t.showToast({icon:"none",title:"登录失败，请稍后试试！",duration:2e3})}))},fail:function(e){t.hideLoading()}})},uploadFile:function(e){var n=this;t.uploadFile({url:(0,a.getConfig)().uploadUrl,fileType:"image",name:"file",filePath:e,header:{"Content-Type":"multipart/form-data"},success:function(e){t.hideLoading();var i=JSON.parse(e.data);console.log(i),200==i.code&&(n.savepth=i.fileName)},fail:function(t){console.log("err",t)}})}}};e.default=s}).call(this,n("df3c")["default"],n("3223")["default"])},9202:function(t,e,n){"use strict";(function(t,e){var i=n("47a9");n("d090");i(n("3240"));var o=i(n("3c13"));t.__webpack_require_UNI_MP_PLUGIN__=n,e(o.default)}).call(this,n("3223")["default"],n("df3c")["createPage"])},a8ac:function(t,e,n){}},[["9202","common/runtime","common/vendor"]]]);