(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/teacher/orderList"],{"12c0":function(e,t,o){"use strict";(function(e){var a=o("47a9");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(o("7eb4")),r=a(o("ee10")),i=o("b816"),u={components:{empty:function(){o.e("pages/active/empty").then(function(){return resolve(o("b7e9"))}.bind(null,o)).catch(o.oe)}},data:function(){return{pageNum:1,pageSize:10,tabCurrentIndex:0,teachModeList:[],navList:[{state:0,text:"全部",loadingType:"more",orderList:[]},{state:1,text:"待付款",loadingType:"more",orderList:[]},{state:2,text:"待服务",loadingType:"more",orderList:[]},{state:3,text:"已完成",loadingType:"more",orderList:[]},{state:4,text:"已关闭",loadingType:"more",orderList:[]}],closeItem:{},serverTime:0}},onLoad:function(e){var t=this;return(0,r.default)(n.default.mark((function o(){return n.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:console.log("options",e),t.tabCurrentIndex=e.state,t.loadTeacherSystemTag(),0==e.state&&t.loadData();case 4:case"end":return o.stop()}}),o)})))()},methods:{loadData:function(e){var t=this;return(0,r.default)(n.default.mark((function o(){var a,r,i,u;return n.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.next=2,t.getServerTime();case 2:if(a=t.tabCurrentIndex,r=t.navList[a],r.state,"tabChange"===e&&(t.pageNum=1,r.loadingType="more",r.orderList=[]),"noMore"!==r.loadingType){o.next=9;break}return console.log("没有更多数据了"),o.abrupt("return");case 9:return r.loadingType="loading",o.next=12,t.loadDataForBackground(t.tabCurrentIndex,t.pageNum,t.pageSize);case 12:i=o.sent,u=i[0],u.forEach((function(e){r.orderList.push(e)})),t.$set(r,"loaded",!0),r.orderList.length>=i[1]?r.loadingType="noMore":(r.loadingType="more",t.pageNum=t.pageNum+1);case 17:case"end":return o.stop()}}),o)})))()},loadDataForBackground:function(t,o,a){var u=this;return(0,r.default)(n.default.mark((function r(){var s,c,d;return n.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return s={},s.pageNum=o,s.pageSize=a,s.createBy=(0,i.getToken)(),0==t&&console.log("全部"),1==t&&(console.log("待付款"),s.orderStatus=3),2==t&&(console.log("待服务"),s.orderStatus=2),3==t&&(console.log("已完成"),s.orderStatus=1),4==t&&(console.log("已关闭"),s.orderStatus=0),c=[],d=[],console.log("requestParam",s),n.next=14,u.request("/app_api/teacher/getTeacherOrderList",s,"GET").then((function(t){if(t){if(console.log("getTeacherOrderList",t),200==t.code){for(var o=t.data[0],a=0;a<o.length;a++){var n=[];if(n[0]={},n[0]["startDate"]=o[a].startDate,n[0]["endDate"]=o[a].endDate,n[0]["sumPrice"]=o[a].sumPrice,n[0]["tcMode"]=o[a].tcMode,n[0]["tcTime"]=o[a].tcTime,c[a]={},c[a]["goodsList"]=n,c[a]["state"]=o[a].orderStatus,0==o[a].orderStatus&&(c[a]["stateTip"]="已关闭",c[a]["stateTipColor"]="#909399"),1==o[a].orderStatus&&(c[a]["stateTip"]="已完成",c[a]["stateTipColor"]="#fa436a"),2==o[a].orderStatus&&(c[a]["stateTip"]="待服务",c[a]["stateTipColor"]="#fa436a"),3==o[a].orderStatus){c[a]["stateTip"]="待付款",c[a]["stateTipColor"]="#fa436a";var r=new Date(o[a].createTime).getTime()/1e3,i=r+600;console.log("serverTime",u.serverTime),console.log("endTime",i),u.serverTime>i&&(console.log("订单超时未支付"),o[a].orderStatus=0,c[a]["stateTip"]="已关闭",c[a]["stateTipColor"]="#909399")}c[a]["time"]=o[a].createTime,c[a]["orderNo"]=o[a].orderNo,c[a]["orderStatus"]=o[a].orderStatus,c[a]["payStatus"]=o[a].payStatus,c[a]["id"]=o[a].id,c[a]["payMoney"]=o[a].payMoney,c[a]["wantPayMoney"]=o[a].wantPayMoney}d[1]=t.data[1]}500==t.code&&e.showToast({title:t.msg,icon:"none",duration:2e3})}})).catch((function(t){e.showToast({title:t,icon:"none",duration:2e3})}));case 14:return d[0]=c,n.abrupt("return",d);case 16:case"end":return n.stop()}}),r)})))()},loadTeacherSystemTag:function(){var e=this;this.request("/app_api/teacher/loadTeacherSystemTag","GET").then((function(t){console.log("loadTeacherSystemTag:",t),t&&(e.teachModeList=t.data[2])}))},changeTab:function(e){this.tabCurrentIndex=e.target.current,this.loadData("tabChange")},tabClick:function(e){this.tabCurrentIndex=e},deleteOrder:function(t){var o=this;e.showLoading({title:"请稍后"}),setTimeout((function(){o.navList[o.tabCurrentIndex].orderList.splice(t,1),e.hideLoading()}),600)},cancelOrder:function(e){this.closeItem=e,this.msgType="info",this.$refs.alertDialog.open()},dialogClose:function(){console.log("点击关闭")},dialogConfirm:function(){var t=this.closeItem;console.log("点击确认");var o={};o.id=t.id,this.request("/app_api/teacher/cancelTeacherOrder",o,"POST").then((function(o){o&&(console.log("cancelTeacherOrder",o),200==o.code&&1==o.data&&(t.orderStatus="0",t.stateTip="已关闭",t.stateTipColor="#909399",e.showToast({title:"取消成功",icon:"none",duration:2e3})))}))},orderStateExp:function(e){var t="",o="#fa436a";switch(+e){case 1:t="待付款";break;case 2:t="待发货";break;case 9:t="订单已关闭",o="#909399";break}return{stateTip:t,stateTipColor:o}},toOrderInfo:function(t){console.log("toOrderInfo",t),e.navigateTo({url:"/pages/teacher/orderListInfo?id="+t.id})},toPay:function(t){e.navigateTo({url:"/pages/active/pay?orderId="+t+"&type=2"})},getServerTime:function(){var e=this;return(0,r.default)(n.default.mark((function t(){return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.request("/app_api/util/getServerTime","","GET").then((function(t){t&&(console.log("getServerTime",t),200==t.code&&(e.serverTime=t.data))}));case 2:case"end":return t.stop()}}),t)})))()}}};t.default=u}).call(this,o("df3c")["default"])},"24d5":function(e,t,o){"use strict";o.r(t);var a=o("12c0"),n=o.n(a);for(var r in a)["default"].indexOf(r)<0&&function(e){o.d(t,e,(function(){return a[e]}))}(r);t["default"]=n.a},4735:function(e,t,o){"use strict";var a=o("b921"),n=o.n(a);n.a},"9e63":function(e,t,o){"use strict";(function(e,t){var a=o("47a9");o("d090");a(o("3240"));var n=a(o("d2ea"));e.__webpack_require_UNI_MP_PLUGIN__=o,t(n.default)}).call(this,o("3223")["default"],o("df3c")["createPage"])},b921:function(e,t,o){},d2ea:function(e,t,o){"use strict";o.r(t);var a=o("dcfd"),n=o("24d5");for(var r in n)["default"].indexOf(r)<0&&function(e){o.d(t,e,(function(){return n[e]}))}(r);o("4735");var i=o("828b"),u=Object(i["a"])(n["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],void 0);t["default"]=u.exports},dcfd:function(e,t,o){"use strict";o.d(t,"b",(function(){return n})),o.d(t,"c",(function(){return r})),o.d(t,"a",(function(){return a}));var a={uniLoadMore:function(){return Promise.all([o.e("common/vendor"),o.e("uni_modules/uni-load-more/components/uni-load-more/uni-load-more")]).then(o.bind(null,"94e9"))},uniPopup:function(){return o.e("uni_modules/uni-popup/components/uni-popup/uni-popup").then(o.bind(null,"8570"))},uniPopupDialog:function(){return Promise.all([o.e("common/vendor"),o.e("uni_modules/uni-popup/components/uni-popup-dialog/uni-popup-dialog")]).then(o.bind(null,"3b6c"))}},n=function(){var e=this,t=e.$createElement,o=(e._self._c,e.__map(e.navList,(function(t,o){var a=e.__get_orig(t),n=!0===t.loaded&&0===t.orderList.length,r=e.__map(t.orderList,(function(t,o){var a=e.__get_orig(t),n=t.goodsList.length;return{$orig:a,g1:n}}));return{$orig:a,g0:n,l0:r}})));e.$mp.data=Object.assign({},{$root:{l1:o}})},r=[]}},[["9e63","common/runtime","common/vendor"]]]);